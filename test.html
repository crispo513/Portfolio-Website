<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>View Counter</title>
  </head>
  <body>
    <h3>👁️ Views: <span id="counter">Loading...</span></h3>
    <button id="click-btn">Click Me</button>

    <script>
      // Load count on page load
      async function loadCount() {
        const res = await fetch('/api/increment'); // GET request
        const data = await res.json();
        document.getElementById('counter').textContent = data.count;
      }

      // Handle click to increment
      async function incrementCount() {
        const res = await fetch('/api/increment', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ row_id: 'eye-clicks' })
        });
        const data = await res.json();
        document.getElementById('counter').textContent = data.count;
      }

      // Wait until DOM is ready
      document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('click-btn').addEventListener('click', incrementCount);
        loadCount();
      });
    </script>
  </body>
</html>
